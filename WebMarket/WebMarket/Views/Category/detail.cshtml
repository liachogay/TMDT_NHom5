@model WebMarket.Models.ProductVM
@{
    Layout = "_Layout";
    ViewData["Title"] = "Index";
}
@ViewBag.id
@section background {
    <!-- breadcrumbs -->
    <div class="breadcrumbs">
        <div class="container">
            <ol class="breadcrumb breadcrumb1 animated wow slideInLeft" data-wow-delay=".5s">
                <li><a href="index.html"><span class="glyphicon glyphicon-home" aria-hidden="true"></span>Home</a></li>
                <li class="active">@ViewBag.name</li>
                <li class="active">@Model.type1</li>
                <li class="active">@Model.Name</li>
            </ol>
        </div>
    </div>
    <!-- //breadcrumbs -->
}
<style>
    h1, h2, h3, h4, h5, h6, a {
        font-family: sans-serif;
        margin: 0;
        font-weight: 700;
    }
    .quantity-product-form {
        margin-bottom: 20px;
        float: left;
    }
</style>

<div class="products">
    <div class="container">
        <div class="agileinfo_single">

            <div class="col-md-4 agileinfo_single_left">
                <img id="example" src="@Url.Content(Model.Image)" alt="@Model.Name" class="img-responsive">
            </div>
            <div class="col-md-8 agileinfo_single_right">
                <h2>@Model.Name</h2>
                <div class="rating1">
                    <span class="starRating">
                        <input id="rating5" type="radio" name="rating" value="5">
                        <label for="rating5">5</label>
                        <input id="rating4" type="radio" name="rating" value="4">
                        <label for="rating4">4</label>
                        <input id="rating3" type="radio" name="rating" value="3" checked="">
                        <label for="rating3">3</label>
                        <input id="rating2" type="radio" name="rating" value="2">
                        <label for="rating2">2</label>
                        <input id="rating1" type="radio" name="rating" value="1">
                        <label for="rating1">1</label>
                    </span>
                </div>
                <div class="w3agile_description">
                    <h4>Description :</h4>
                    <p>
                        @Model.Description
                    </p>
                </div>
                <div class="snipcart-item block">
                    <div class="snipcart-thumb agileinfo_single_right_snipcart">
                        <h3>
                            @Model.NewPrice Vnd<del>
                            @if (Model.Discount > 0)
                            {
                                @Model.Price
                            }
                        </del>
                    </h3>
                </div>
                <div class="snipcart-details agileinfo_single_right_details">

                    <input type="hidden" value="@Model.Id" class="id-product-form" />
                    <input type="number" value="1" class="quantity-product-form" min="1" max="100" />
                    <input type="submit" name="submit" value="Add to cart" class="button add-form">

                </div>
            </div>
        </div>
        <div class="clearfix"> </div>
    </div>
</div>
</div>
<!-- new -->
<div class="newproducts-w3agile">
    <div class="container">
        <h3>New offers</h3>
        <div class="agile_top_brands_grids">
            @foreach (var item in ViewBag.offeritems)
            {
                <div class="col-md-3 top_brand_left-1">
                    <div class="hover14 column">
                        <div class="agile_top_brand_left_grid">
                            <div class="agile_top_brand_left_grid_pos">
                                <img src="~/images/offer.png" alt=" " class="img-responsive" />
                            </div>
                            <div class="agile_top_brand_left_grid1">
                                <figure>
                                    <div class="snipcart-item block" data-id="@item.Id">
                                        <div class="snipcart-thumb">
                                            <a href="~/Category/@item.category/@item.type1/Detail/@item.EncryptedId"><img title=" " alt=" " src="@Url.Content(item.Image)" width="150px" height="150px" /></a>
                                            <p style="height:63px;">@item.Name</p>

                                            <div class="stars">
                                                <i class="fa fa-star blue-star" aria-hidden="true"></i>
                                                <i class="fa fa-star blue-star" aria-hidden="true"></i>
                                                <i class="fa fa-star blue-star" aria-hidden="true"></i>
                                                <i class="fa fa-star blue-star" aria-hidden="true"></i>
                                                <i class="fa fa-star gray-star" aria-hidden="true"></i>
                                            </div>
                                            <h4>
                                                @item.NewPrice <del>
                                                    @if (item.Discount > 0)
                                                    {
                                                        @item.Price
                                                    }
                                                </del>
                                            </h4>
                                        </div>
                                        <div class="snipcart-details top_brand_home_details">
                                            <input type="hidden" value="@item.Description" />
                                            <input type="submit" name="submit" value="Add to cart" class="button show" data-toggle="modal" data-target="#modal-cart" />
                                        </div>
                                    </div>
                                </figure>
                            </div>
                        </div>
                    </div>
                </div>
            }

            <div class="clearfix"> </div>
        </div>
    </div>
</div>
<!-- //new -->

<div class="modal fade" id="modal-cart" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered " role="document">
        <div class="modal-content" style="margin:0 120px;">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLongTitle"></h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" data-id="">
                <div class="row">
                    <div class="col-md-4 ">
                        <img src="" width="150px" height="150px">
                    </div>
                    <div class="col-md-8 ">
                        <div style="font-size:17px;font-weight:200"><span class="modal-item-name"></span></div>
                        <div style="font-size:17px;font-weight:200"><span class="modal-item-price"></span> </div>
                        <div style="font-size:17px;font-weight:200"> <input type="number" value="1" name="quantity" min="1" max="100" /></div>
                        <p style="margin-top:10px;">At PepsiCo, we aim to give consumers choices. Our full range of food and beverages are designed to bring a smile to anyone’s face, anytime, anywhere</p>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary add-to-cart">Add To Cart</button>
            </div>
        </div>
    </div>
</div>
<script>
    $(".quantity-product-form").change(function () {
        if ($(this).val() < 1) {
            $(this).val(1);
        }
    });
    $(".add-form").click(function () {
        const form = $(this).parent();
        let id = form.find(".id-product-form").val();
        let quantity = form.find(".quantity-product-form").val();
        $.ajax({
            type: "POST",
            url: '/Cart/AddToCart',
            data: {
                'id': id,
                'quantity': quantity,
            },
            success: function (data) {
                Swal.fire({
                    icon: 'success',
                    title: 'Thêm giỏ hàng thành công',
                    showConfirmButton: false,
                    timer: 1500
                });
                $(".count").text(data.quantity);
            },
            error: function () {
                Swal.fire({
                    icon: 'error',
                    title: 'Thêm giỏ hàng thất bại',
                    text: 'Vui lòng thử lại',
                    showConfirmButton: false,
                    timer: 1500
                });
            },
        })
    })
</script>
<script src="~/js/cart.js"></script>